from imports import *
from csv_response import generateCSVresponse

def healthcheck(arg):
  #print(arg)
  url = 'http://localhost:5000/admin/healthcheck'
  if (arg.format == 'csv'):
    url = url + '?format=csv'
  res = requests.get(url, headers=find_key(), verify=False)
  if (arg.format == 'json' and res.status_code == 200):
    #print(res.status_code)
    print(res.json())
  elif (arg.format == 'csv' and res.status_code == 200):
    # f = open("./healthcheck.csv", 'w+') 
    # print(res.text)
    # print(res)
    # f.truncate()
    # f.write(res.text)
    # #f.seek(0)
    # x = from_csv(f, delimiter=',')
    # x.set_style(DEFAULT)
    # print(x)
    # f.close()
    print(res.text)
  else:
    print(res.status_code)
    print(res.json())
  return True


parser = argparse.ArgumentParser()
parser.add_argument('--format',
                    choices=['csv', 'json'],
                    help='Select json or csv format',
                    required='TRUE')
args = parser.parse_args()

healthcheck(args)
