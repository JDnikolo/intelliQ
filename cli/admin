from imports import *


def usermod(arg):
  #print(arg)
  url = 'http://localhost:9103/admin/usermod/' + arg.username + '/' + arg.passw
  #take api key from file saved from login
  headers = None
  home = str(Path.home())
  if os.path.exists(home + '/softeng22API.token'):
    f = open(home + '/softeng22API.token', 'r')
    content = f.read()
    headers = {'x-observatory-auth': content}
  res = requests.post(url, headers=headers, verify=False)
  print(res.status_code)
  print(res.json())
  return True


def users(arg):
  #print(ar)
  url = 'http://localhost:9103/admin/users/' + arg.username
  #take api key from file saved from login
  headers = None
  home = str(Path.home())
  if os.path.exists(home + '/softeng22API.token'):
    f = open(home + '/softeng22API.token', 'r')
    content = f.read()
    headers = {'x-observatory-auth': content}
  res = requests.get(url, headers=headers, verify=False)
  print(res.status_code)
  print(res.json())
  return True


if __name__ == '__main__':
  parser = argparse.ArgumentParser()

  sub = parser.add_subparsers()
  #usermod
  usermod_parser = sub.add_parser('--usermod')
  usermod_parser.add_argument('--username')
  usermod_parser.add_argument('--passw')

  #username
  #username_parser = admin_parser.add_parser('--username')
  #username_parser.add_argument('--passw')

  #passw
  #passw_parser = admin_parser.add_parser('--passw')

  #users
  #users_parser = admin_parser.add_parser('--users')

  args = parser.parse_args()

  if hasattr(args, 'func'):
    if args.func.__name__ == 'usermod':
      usermod(args)
    elif args.func.__name__ == 'users':
      users(args)
  else:
    parser.print_help()